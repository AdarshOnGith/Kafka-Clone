server:
  port: ${SERVER_PORT:8081}  # Use SERVER_PORT environment variable or default to 8081

spring:
  application:
    name: dmq-storage-service

# DMQ Storage Service Configuration
dmq:
  storage:
    # Broker Configuration - Environment variable overrides only
    broker:
      id: ${BROKER_ID:}
      host: ${BROKER_HOST:}
      port: ${BROKER_PORT:}
      data-dir: ${DATA_DIR:}

    # Metadata Service Configuration
    metadata:
      service-url: ${METADATA_SERVICE_URL:}

    # WAL Configuration
    wal:
      segment-size-bytes: ${WAL_SEGMENT_SIZE_BYTES:}
      flush-interval-ms: ${WAL_FLUSH_INTERVAL_MS:}
      retention-check-interval-ms: ${WAL_RETENTION_CHECK_INTERVAL_MS:}
      data-dir: ${WAL_DATA_DIR:}
      logs-dir: ${LOGS_DIR:}

    # Replication Configuration
    replication:
      fetch-max-bytes: ${REPLICATION_FETCH_MAX_BYTES:}
      fetch-max-wait-ms: ${REPLICATION_FETCH_MAX_WAIT_MS:}
      replica-lag-time-max-ms: ${REPLICATION_REPLICA_LAG_TIME_MAX_MS:}

    # Consumer Configuration
    consumer:
      default-max-messages: ${CONSUMER_DEFAULT_MAX_MESSAGES:}

logging:
  level:
    com.distributedmq: DEBUG
    org.springframework: INFO
